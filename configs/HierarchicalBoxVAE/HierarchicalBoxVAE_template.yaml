model:
  type: "HierarchicalBoxVAE"
  config:
    embed_dim: 8
    grid_size: [4, 4]
    input_resolution: [64, 64]
    crop_padding_range: [4,8]
    beta_scale: 0.4
    beta_pre_init: -2.0
    beta_activation: sigmoid
    vae_config:
      hidden_dims: [32, 64, 128, 256]
    prior_config:
      boxes_per_level: [int, int]
      gumbel_temp: float
      gumbel_hard: bool
      init_config:
        center_variance: float
        width_variance: float
        min_width: float
        sparse_init: bool
        num_init_connections: int
        logit_value: float
    pull_loss_method: str - options - ["corner_distance", "box_likelihood"]
    pull_assignment_temperature: float
    pull_assignment_activation: str - options - ["softmax", "gumbel_softmax"]
    pull_assignment_hard: bool
    pull_loss_start_epoch: int
    pull_loss_warmup_epochs: int
    disjoint_loss_method: list - options - ["intersection_volume", "centroid_distance"]
    loss_weights:
      patch_pull_loss: float
      full_image_pull_loss: float
      patch_mse_loss: float
      patch_ssim_loss: float
      full_image_mse_loss: float
      full_image_ssim_loss: float
      l0_entropy_loss: float
      l1_entropy_loss: float
      l0_vol_penalty: float
      l1_vol_penalty: float
      l0_disjoint_loss: float
      l1_disjoint_loss: float
      patch_disjoint_loss: float
      full_image_disjoint_loss: float

data:
  train:
    type: v0Dataset
    config:
      image_size: [64, 64]
      shapes: ["circle", "square"]
      colors: ["red"]
      num_samples: 1000
      return_metadata: True
      center_range: [16, 48]
      size_range: [10, 30]
    dataloader_config:
      batch_size: 32
      shuffle: True

trainer:
  max_epochs: 100
  optimizer:
    type: Adam
    config:
      vae_lr: 0.0001
      prior_lr: 0.0001